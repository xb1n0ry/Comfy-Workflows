{"id":"6a79fc9e-d9eb-40ed-af74-14535bedd4a9","revision":0,"last_node_id":180,"last_link_id":365,"nodes":[{"id":3,"type":"KSampler","pos":[1630,80],"size":[300,474],"flags":{},"order":17,"mode":0,"inputs":[{"localized_name":"model","name":"model","type":"MODEL","link":186},{"localized_name":"positive","name":"positive","type":"CONDITIONING","link":272},{"localized_name":"negative","name":"negative","type":"CONDITIONING","link":276},{"localized_name":"latent_image","name":"latent_image","type":"LATENT","link":302},{"localized_name":"seed","name":"seed","type":"INT","widget":{"name":"seed"},"link":null},{"localized_name":"steps","name":"steps","type":"INT","widget":{"name":"steps"},"link":null},{"localized_name":"cfg","name":"cfg","type":"FLOAT","widget":{"name":"cfg"},"link":null},{"localized_name":"sampler_name","name":"sampler_name","type":"COMBO","widget":{"name":"sampler_name"},"link":null},{"localized_name":"scheduler","name":"scheduler","type":"COMBO","widget":{"name":"scheduler"},"link":null},{"localized_name":"denoise","name":"denoise","type":"FLOAT","widget":{"name":"denoise"},"link":null}],"outputs":[{"localized_name":"LATENT","name":"LATENT","type":"LATENT","slot_index":0,"links":[128]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.48","Node name for S&R":"KSampler","enableTabs":false,"tabWidth":65,"tabXOffset":10,"hasSecondTab":false,"secondTabText":"Send Back","secondTabOffset":80,"secondTabWidth":65,"ue_properties":{"version":"7.1","widget_ue_connectable":{},"input_ue_unconnectable":{}}},"widgets_values":[58130559387586,"randomize",4,1,"euler","simple",1]},{"id":159,"type":"PreviewImage","pos":[1360,-980],"size":[480,580],"flags":{},"order":21,"mode":0,"inputs":[{"localized_name":"images","name":"images","type":"IMAGE","link":363}],"outputs":[],"properties":{"cnr_id":"comfy-core","ver":"0.3.60","Node name for S&R":"PreviewImage","ue_properties":{"widget_ue_connectable":{},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":[]},{"id":172,"type":"AILab_ImageCombiner","pos":[1860,-610],"size":[320,194],"flags":{},"order":20,"mode":0,"inputs":[{"localized_name":"foreground","name":"foreground","type":"IMAGE","link":362},{"localized_name":"background","name":"background","type":"IMAGE","link":361},{"localized_name":"foreground_mask","name":"foreground_mask","shape":7,"type":"MASK","link":null},{"localized_name":"mode","name":"mode","type":"COMBO","widget":{"name":"mode"},"link":null},{"localized_name":"foreground_opacity","name":"foreground_opacity","type":"FLOAT","widget":{"name":"foreground_opacity"},"link":null},{"localized_name":"foreground_scale","name":"foreground_scale","type":"FLOAT","widget":{"name":"foreground_scale"},"link":null},{"localized_name":"position_x","name":"position_x","type":"INT","widget":{"name":"position_x"},"link":null},{"localized_name":"position_y","name":"position_y","type":"INT","widget":{"name":"position_y"},"link":null}],"outputs":[{"localized_name":"IMAGE","name":"IMAGE","type":"IMAGE","links":[363]},{"localized_name":"WIDTH","name":"WIDTH","type":"INT","links":null},{"localized_name":"HEIGHT","name":"HEIGHT","type":"INT","links":null}],"properties":{"cnr_id":"comfyui-rmbg","ver":"d38178a5639b5b0ccec4124d7652a8b2594df2db","Node name for S&R":"AILab_ImageCombiner","ue_properties":{"widget_ue_connectable":{"mode":true,"foreground_opacity":true,"foreground_scale":true,"position_x":true,"position_y":true},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":["normal",1,1,50,50],"color":"#2e3e57","bgcolor":"#4b5b73"},{"id":170,"type":"PreviewImage","pos":[2190,-980],"size":[270,300],"flags":{},"order":15,"mode":0,"inputs":[{"localized_name":"images","name":"images","type":"IMAGE","link":360}],"outputs":[],"properties":{"cnr_id":"comfy-core","ver":"0.3.60","Node name for S&R":"PreviewImage","ue_properties":{"widget_ue_connectable":{},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":[]},{"id":38,"type":"CLIPLoader","pos":[560,50],"size":[460,106],"flags":{},"order":0,"mode":0,"inputs":[{"localized_name":"clip_name","name":"clip_name","type":"COMBO","widget":{"name":"clip_name"},"link":null},{"localized_name":"type","name":"type","type":"COMBO","widget":{"name":"type"},"link":null},{"localized_name":"device","name":"device","shape":7,"type":"COMBO","widget":{"name":"device"},"link":null}],"outputs":[{"localized_name":"CLIP","name":"CLIP","type":"CLIP","slot_index":0,"links":[269,273]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.48","Node name for S&R":"CLIPLoader","models":[{"name":"qwen_2.5_vl_7b_fp8_scaled.safetensors","url":"https://huggingface.co/Comfy-Org/Qwen-Image_ComfyUI/resolve/main/split_files/text_encoders/qwen_2.5_vl_7b_fp8_scaled.safetensors","directory":"text_encoders"}],"enableTabs":false,"tabWidth":65,"tabXOffset":10,"hasSecondTab":false,"secondTabText":"Send Back","secondTabOffset":80,"secondTabWidth":65,"ue_properties":{"version":"7.1","widget_ue_connectable":{},"input_ue_unconnectable":{}}},"widgets_values":["qwen_2.5_vl_7b_fp8_scaled.safetensors","qwen_image","default"]},{"id":171,"type":"RMBG","pos":[1870,-980],"size":[300,302],"flags":{},"order":13,"mode":0,"inputs":[{"localized_name":"image","name":"image","type":"IMAGE","link":359},{"localized_name":"model","name":"model","type":"COMBO","widget":{"name":"model"},"link":null},{"localized_name":"sensitivity","name":"sensitivity","shape":7,"type":"FLOAT","widget":{"name":"sensitivity"},"link":null},{"localized_name":"process_res","name":"process_res","shape":7,"type":"INT","widget":{"name":"process_res"},"link":null},{"localized_name":"mask_blur","name":"mask_blur","shape":7,"type":"INT","widget":{"name":"mask_blur"},"link":null},{"localized_name":"mask_offset","name":"mask_offset","shape":7,"type":"INT","widget":{"name":"mask_offset"},"link":null},{"localized_name":"invert_output","name":"invert_output","shape":7,"type":"BOOLEAN","widget":{"name":"invert_output"},"link":null},{"localized_name":"refine_foreground","name":"refine_foreground","shape":7,"type":"BOOLEAN","widget":{"name":"refine_foreground"},"link":null},{"localized_name":"background","name":"background","shape":7,"type":"COMBO","widget":{"name":"background"},"link":null},{"localized_name":"background_color","name":"background_color","shape":7,"type":"COLOR","widget":{"name":"background_color"},"link":null}],"outputs":[{"localized_name":"IMAGE","name":"IMAGE","type":"IMAGE","links":[360,362]},{"localized_name":"MASK","name":"MASK","type":"MASK","links":null},{"localized_name":"MASK_IMAGE","name":"MASK_IMAGE","type":"IMAGE","links":null}],"properties":{"cnr_id":"comfyui-rmbg","ver":"d38178a5639b5b0ccec4124d7652a8b2594df2db","Node name for S&R":"RMBG","ue_properties":{"widget_ue_connectable":{"model":true,"sensitivity":true,"process_res":true,"mask_blur":true,"mask_offset":true,"invert_output":true,"refine_foreground":true,"background":true,"background_color":true},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":["INSPYRENET",1,1024,0,0,false,false,"Alpha","#222222"],"color":"#222e40","bgcolor":"#364254"},{"id":99,"type":"MarkdownNote","pos":[220,-120],"size":[320,380],"flags":{},"order":1,"mode":0,"inputs":[],"outputs":[],"title":"Model links","properties":{"ue_properties":{"version":"7.1","widget_ue_connectable":{},"input_ue_unconnectable":{}}},"widgets_values":["## Model links\n\n**Diffusion model**\n\n- [nunchaku-tech/nunchaku-qwen-image-edit-2509](https://huggingface.co/nunchaku-tech/nunchaku-qwen-image-edit-2509)\n\nR32 4-steps is perfectly fine for this job.\n\n**Text encoder**\n\n- [qwen_2.5_vl_7b_fp8_scaled.safetensors](https://huggingface.co/Comfy-Org/Qwen-Image_ComfyUI/resolve/main/split_files/text_encoders/qwen_2.5_vl_7b_fp8_scaled.safetensors)\n\n**VAE**\n\n- [qwen_image_vae.safetensors](https://huggingface.co/Comfy-Org/Qwen-Image_ComfyUI/resolve/main/split_files/vae/qwen_image_vae.safetensors)\n\n\n"],"color":"#432","bgcolor":"#653"},{"id":39,"type":"VAELoader","pos":[560,210],"size":[460,58],"flags":{},"order":2,"mode":0,"inputs":[{"localized_name":"vae_name","name":"vae_name","type":"COMBO","widget":{"name":"vae_name"},"link":null}],"outputs":[{"localized_name":"VAE","name":"VAE","type":"VAE","slot_index":0,"links":[76,168,270,274]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.48","Node name for S&R":"VAELoader","models":[{"name":"qwen_image_vae.safetensors","url":"https://huggingface.co/Comfy-Org/Qwen-Image_ComfyUI/resolve/main/split_files/vae/qwen_image_vae.safetensors","directory":"vae"}],"enableTabs":false,"tabWidth":65,"tabXOffset":10,"hasSecondTab":false,"secondTabText":"Send Back","secondTabOffset":80,"secondTabWidth":65,"ue_properties":{"version":"7.1","widget_ue_connectable":{},"input_ue_unconnectable":{}}},"widgets_values":["qwen_image_vae.safetensors"]},{"id":88,"type":"VAEEncode","pos":[1190,170],"size":[140,46],"flags":{"collapsed":false},"order":9,"mode":0,"inputs":[{"localized_name":"pixels","name":"pixels","type":"IMAGE","link":307},{"localized_name":"vae","name":"vae","type":"VAE","link":168}],"outputs":[{"localized_name":"LATENT","name":"LATENT","type":"LATENT","links":[302]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.50","Node name for S&R":"VAEEncode","enableTabs":false,"tabWidth":65,"tabXOffset":10,"hasSecondTab":false,"secondTabText":"Send Back","secondTabOffset":80,"secondTabWidth":65,"ue_properties":{"widget_ue_connectable":{},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":[]},{"id":8,"type":"VAEDecode","pos":[1190,260],"size":[140,46],"flags":{"collapsed":false},"order":18,"mode":0,"inputs":[{"localized_name":"samples","name":"samples","type":"LATENT","link":128},{"localized_name":"vae","name":"vae","type":"VAE","link":76}],"outputs":[{"localized_name":"IMAGE","name":"IMAGE","type":"IMAGE","slot_index":0,"links":[110,361]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.48","Node name for S&R":"VAEDecode","enableTabs":false,"tabWidth":65,"tabXOffset":10,"hasSecondTab":false,"secondTabText":"Send Back","secondTabOffset":80,"secondTabWidth":65,"ue_properties":{"version":"7.1","widget_ue_connectable":{},"input_ue_unconnectable":{}}},"widgets_values":[]},{"id":139,"type":"TextEncodeQwenImageEditPlus","pos":[1190,350],"size":[420,200],"flags":{"collapsed":false},"order":11,"mode":0,"inputs":[{"localized_name":"clip","name":"clip","type":"CLIP","link":273},{"localized_name":"vae","name":"vae","shape":7,"type":"VAE","link":274},{"localized_name":"image1","name":"image1","shape":7,"type":"IMAGE","link":310},{"localized_name":"image2","name":"image2","shape":7,"type":"IMAGE","link":null},{"localized_name":"image3","name":"image3","shape":7,"type":"IMAGE","link":null},{"localized_name":"prompt","name":"prompt","type":"STRING","widget":{"name":"prompt"},"link":null}],"outputs":[{"localized_name":"CONDITIONING","name":"CONDITIONING","type":"CONDITIONING","links":[276]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.60","Node name for S&R":"TextEncodeQwenImageEditPlus","ue_properties":{"widget_ue_connectable":{"prompt":true},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":[""]},{"id":151,"type":"ResizeAndPadImage","pos":[1390,170],"size":[220,130],"flags":{},"order":3,"mode":0,"inputs":[{"localized_name":"image","name":"image","type":"IMAGE","link":365},{"localized_name":"target_width","name":"target_width","type":"INT","widget":{"name":"target_width"},"link":null},{"localized_name":"target_height","name":"target_height","type":"INT","widget":{"name":"target_height"},"link":null},{"localized_name":"padding_color","name":"padding_color","type":"COMBO","widget":{"name":"padding_color"},"link":null},{"localized_name":"interpolation","name":"interpolation","type":"COMBO","widget":{"name":"interpolation"},"link":null}],"outputs":[{"localized_name":"IMAGE","name":"IMAGE","type":"IMAGE","links":[307,309,310,355,359]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.60","Node name for S&R":"ResizeAndPadImage","ue_properties":{"widget_ue_connectable":{"target_width":true,"target_height":true,"padding_color":true,"interpolation":true},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":[1024,1024,"white","lanczos"]},{"id":75,"type":"CFGNorm","pos":[1630,-30],"size":[300,60],"flags":{},"order":16,"mode":0,"inputs":[{"localized_name":"model","name":"model","type":"MODEL","link":141},{"localized_name":"strength","name":"strength","type":"FLOAT","widget":{"name":"strength"},"link":null}],"outputs":[{"localized_name":"patched_model","name":"patched_model","type":"MODEL","links":[186]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.50","Node name for S&R":"CFGNorm","enableTabs":false,"tabWidth":65,"tabXOffset":10,"hasSecondTab":false,"secondTabText":"Send Back","secondTabOffset":80,"secondTabWidth":65,"ue_properties":{"widget_ue_connectable":{"strength":true},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":[1]},{"id":66,"type":"ModelSamplingAuraFlow","pos":[1630,-140],"size":[300,60],"flags":{},"order":14,"mode":0,"inputs":[{"localized_name":"model","name":"model","type":"MODEL","link":228},{"localized_name":"shift","name":"shift","type":"FLOAT","widget":{"name":"shift"},"link":null}],"outputs":[{"localized_name":"MODEL","name":"MODEL","type":"MODEL","links":[141]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.48","Node name for S&R":"ModelSamplingAuraFlow","enableTabs":false,"tabWidth":65,"tabXOffset":10,"hasSecondTab":false,"secondTabText":"Send Back","secondTabOffset":80,"secondTabWidth":65,"ue_properties":{"version":"7.1","widget_ue_connectable":{},"input_ue_unconnectable":{}}},"widgets_values":[3]},{"id":60,"type":"SaveImage","pos":[830,-980],"size":[490,580],"flags":{},"order":19,"mode":0,"inputs":[{"localized_name":"images","name":"images","type":"IMAGE","link":110},{"localized_name":"filename_prefix","name":"filename_prefix","type":"STRING","widget":{"name":"filename_prefix"},"link":null}],"outputs":[],"properties":{"cnr_id":"comfy-core","ver":"0.3.48","Node name for S&R":"SaveImage","enableTabs":false,"tabWidth":65,"tabXOffset":10,"hasSecondTab":false,"secondTabText":"Send Back","secondTabOffset":80,"secondTabWidth":65,"ue_properties":{"version":"7.1","widget_ue_connectable":{},"input_ue_unconnectable":{}}},"widgets_values":["ComfyUI"]},{"id":175,"type":"Fast Groups Bypasser (rgthree)","pos":[1660,-1150],"size":[450,82],"flags":{},"order":4,"mode":0,"inputs":[],"outputs":[{"name":"OPT_CONNECTION","type":"*","links":null}],"properties":{"matchColors":"","matchTitle":"","showNav":true,"showAllGraphs":true,"sort":"position","customSortAlphabet":"","toggleRestriction":"default","ue_properties":{"widget_ue_connectable":{},"version":"7.1","input_ue_unconnectable":{}}},"color":"#432","bgcolor":"#653"},{"id":115,"type":"NunchakuQwenImageDiTLoader","pos":[560,-130],"size":[460,130],"flags":{},"order":5,"mode":0,"inputs":[{"localized_name":"model_name","name":"model_name","type":"COMBO","widget":{"name":"model_name"},"link":null},{"localized_name":"cpu_offload","name":"cpu_offload","type":"COMBO","widget":{"name":"cpu_offload"},"link":null},{"localized_name":"num_blocks_on_gpu","name":"num_blocks_on_gpu","shape":7,"type":"INT","widget":{"name":"num_blocks_on_gpu"},"link":null},{"localized_name":"use_pin_memory","name":"use_pin_memory","shape":7,"type":"COMBO","widget":{"name":"use_pin_memory"},"link":null}],"outputs":[{"localized_name":"MODEL","name":"MODEL","type":"MODEL","links":[228]}],"properties":{"cnr_id":"ComfyUI-nunchaku","ver":"d9405a6305efc4dc758bdeec500fc5d695215b2b","Node name for S&R":"NunchakuQwenImageDiTLoader","ue_properties":{"widget_ue_connectable":{},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":["svdq-int4_r32-qwen-image-edit-2509-lightningv2.0-4steps.safetensors","enable",20,"disable"]},{"id":138,"type":"TextEncodeQwenImageEditPlus","pos":[1190,-130],"size":[420,250],"flags":{},"order":10,"mode":0,"inputs":[{"localized_name":"clip","name":"clip","type":"CLIP","link":269},{"localized_name":"vae","name":"vae","shape":7,"type":"VAE","link":270},{"localized_name":"image1","name":"image1","shape":7,"type":"IMAGE","link":309},{"localized_name":"image2","name":"image2","shape":7,"type":"IMAGE","link":null},{"localized_name":"image3","name":"image3","shape":7,"type":"IMAGE","link":null},{"localized_name":"prompt","name":"prompt","type":"STRING","widget":{"name":"prompt"},"link":null}],"outputs":[{"localized_name":"CONDITIONING","name":"CONDITIONING","type":"CONDITIONING","links":[272]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.60","Node name for S&R":"TextEncodeQwenImageEditPlus","ue_properties":{"widget_ue_connectable":{"prompt":true},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":["Seamlessly extend the scene to fill the padded white bars, outpainting and continuing the existing environment with matching patterns, shapes and textures. Do not modify or repaint the characters’ faces, hairstyles, clothing, or any other distinctive details. Do not change the color and contrast of the image. Focus only on generating new, contextually appropriate background or environmental elements to fill the padded regions. Ensure perfect blending at the edges with no visible seams, artifacts, or style shifts. Maintain the same artistic style, perspective, and overall visual fidelity."]},{"id":177,"type":"Note","pos":[1720,-270],"size":[320,88],"flags":{},"order":6,"mode":0,"inputs":[],"outputs":[],"properties":{"ue_properties":{"widget_ue_connectable":{},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":["You don't need to change anything here"],"color":"#432","bgcolor":"#653"},{"id":168,"type":"PreviewImage","pos":[1950,-140],"size":[520,690],"flags":{},"order":12,"mode":0,"inputs":[{"localized_name":"images","name":"images","type":"IMAGE","link":355}],"outputs":[],"properties":{"cnr_id":"comfy-core","ver":"0.3.60","Node name for S&R":"PreviewImage","ue_properties":{"widget_ue_connectable":{},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":[]},{"id":174,"type":"Note","pos":[1340,-1380],"size":[1140,190],"flags":{},"order":7,"mode":0,"inputs":[],"outputs":[],"properties":{"ue_properties":{"widget_ue_connectable":{},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":["First of all, this procedure is highly experimental. A lot of things can go wrong but I have not faced any issues yet.\nThis step extracts the person from the original input image and places them back onto the newly outpainted image. Qwen sometimes alters the character’s appearance or lowers the overall quality, so this procedure ensures the person is reinserted with the best possible fidelity — which is crucial for high-quality LoRA training.\n\nNote: If Qwen extends any parts of the character’s body, you may occasionally see a 1-pixel seam along the overlap. This is generally not an issue for LoRA training. Additionally, background removal can sometimes create a halo effect around the subject. Try different RMBG models and see which one works best for you.\nIf you prefer to keep Qwen’s generated version untouched, you can simply bypass this entire group.\n\nImportant: All nodes in this group rely on consistent resolution references (eg 1024px). These values are essential to position the person precisely in the same location as the original. Changing these values can cause misalignment, so proceed with caution."],"color":"#432","bgcolor":"#653"},{"id":180,"type":"LoadImage","pos":[200,-980],"size":[600,580],"flags":{},"order":8,"mode":0,"inputs":[{"localized_name":"image","name":"image","type":"COMBO","widget":{"name":"image"},"link":null},{"localized_name":"upload","name":"upload","type":"IMAGEUPLOAD","widget":{"name":"upload"},"link":null}],"outputs":[{"localized_name":"IMAGE","name":"IMAGE","type":"IMAGE","links":[365]},{"localized_name":"MASK","name":"MASK","type":"MASK","links":null}],"properties":{"cnr_id":"comfy-core","ver":"0.3.60","Node name for S&R":"LoadImage"},"widgets_values":["Generated Image September 22, 2025 - 6_12AM.png","image"]}],"links":[[76,39,0,8,1,"VAE"],[110,8,0,60,0,"IMAGE"],[128,3,0,8,0,"LATENT"],[141,66,0,75,0,"MODEL"],[168,39,0,88,1,"VAE"],[186,75,0,3,0,"MODEL"],[228,115,0,66,0,"MODEL"],[269,38,0,138,0,"CLIP"],[270,39,0,138,1,"VAE"],[272,138,0,3,1,"CONDITIONING"],[273,38,0,139,0,"CLIP"],[274,39,0,139,1,"VAE"],[276,139,0,3,2,"CONDITIONING"],[302,88,0,3,3,"LATENT"],[307,151,0,88,0,"IMAGE"],[309,151,0,138,2,"IMAGE"],[310,151,0,139,2,"IMAGE"],[355,151,0,168,0,"IMAGE"],[359,151,0,171,0,"IMAGE"],[360,171,0,170,0,"IMAGE"],[361,8,0,172,1,"IMAGE"],[362,171,0,172,0,"IMAGE"],[363,172,0,159,0,"IMAGE"],[365,180,0,151,0,"IMAGE"]],"groups":[{"id":1,"title":"Cut the person, paste back on the extended image","bounding":[1350,-1060,1120,670],"color":"#b58b2a","font_size":24,"flags":{}}],"config":{},"extra":{"ds":{"scale":0.7972024500000091,"offset":[314.7446358238253,1231.2548099187745]},"frontendVersion":"1.26.13","ue_links":[],"links_added_by_ue":[],"VHS_latentpreview":false,"VHS_latentpreviewrate":0,"VHS_MetadataImage":true,"VHS_KeepIntermediate":true},"version":0.4}